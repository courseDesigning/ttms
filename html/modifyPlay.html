<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>修改剧目</title>
    <link rel="stylesheet" href="../lib/bootstrap.min.css">
    <script src="https://cdn.bootcss.com/jquery/1.12.4/jquery.min.js"></script>
    <script src="../lib/bootstrap.min.js"></script>
    <link rel="stylesheet" href="../css/play.css">
</head>
<script>
    window.onload = function () {
        var url = decodeURI(location.href);
        console.log(url);
        var getVal = url.split('?')[1];
        var name = getVal.split('=')[1];
        console.log(name);
        $.ajax({
            url: `http://123.206.67.174:18000/film/querys?`,
            type: 'get',
            datatype: 'jsonp',
            data: {
                film_name: name
            },
            crossDomain: true, xhrFields: {withCredentials: true},
            success: function (data) {
                var object = data.Detail[0];
                console.log("film_name+++++", object);
                $('#name').attr("value", `${object.film_name}`);
                $('#name').attr("disabled", `disabled`);
                $('#star').attr("value", `${object.film_tostar}`);
                $('#release').attr("value", `${object.film_release}`);
                $('#hourlong').attr("value", `${object.film_hourlong}`);
                $('#type').attr("value", `${object.film_type}`);
                $('#price').attr("value", `${object.film_price}`);
            }
        });
        document.getElementById("goBackToPlay").addEventListener("click", function () {
            window.location.href = "play.html";
        });

        document.getElementById("submit").addEventListener("click", function () {
            var name = document.getElementById("name").value;
            var star = document.getElementById("star").value;
            var release = document.getElementById("release").value;
            var hourlong = document.getElementById("hourlong").value;
            var type = document.getElementById("type").value;
            var price = document.getElementById("price").value;
            $.ajax({
                url: `http://123.206.67.174:18000/film/updata?`,
                type: 'get',
                datatype: 'jsonp',
                data: {
                    film_name: name,
                    film_tostar: star,
                    film_release: release,
                    film_hourlong: hourlong,
                    film_type: type,
                    film_price: price
                },
                crossDomain: true, xhrFields: {withCredentials: true},
                success: function (data) {
                    if (data.Detail.status) {
                        document.getElementById("addWarning").innerHTML = "修改成功！";
                        window.location.href = 'play.html';
                    } else {
                        document.getElementById("addWarning").innerHTML = "修改失败！";
                    }
                }
            });
        })
    }
</script>
<body>
<div class="playTheme">
    <h1 class="textStyle">修改剧目</h1>
</div>
<div>
    <div style="margin-left: 45%">
        <span id="addWarning"></span>
    </div>
    <div>
        <input type="text" placeholder="请输入影片名字" class="form-control  btn btn-default addInput" id="name">
    </div>
    <div>
        <input type="text" placeholder="请输入影片主演" class="form-control  btn btn-default addInput" id="star">
    </div>
    <div>
        <input type="text" placeholder="请输入影片上映时间" class="form-control  btn btn-default addInput" id="release">
    </div>
    <div>
        <input type="text" placeholder="请输入影片时长" class="form-control  btn btn-default addInput" id="hourlong">
    </div>
    <div>
        <input type="text" placeholder="请输入影片类型" class="form-control  btn btn-default addInput" id="type">
    </div>
    <div>
        <input type="text" placeholder="请输入影片价格" class="form-control  btn btn-default addInput" id="price">
    </div>
    <div class="addButton">
        <button type="button" class="btn btn-default" style="margin-right: 20px" id="goBackToPlay">返回</button>
        <button type="button" class="btn btn-default" id="submit">提交</button>
    </div>
</div>
</body>
</html>